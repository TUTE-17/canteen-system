<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Staff Sign Up</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .glitter {
      position: relative;
      animation: glow 2s infinite alternate;
      box-shadow: 0 0 20px rgba(221, 7, 7, 0.2),
                  0 0 40px rgba(210, 17, 201, 0.15),
                  0 0 60px rgba(228, 114, 8, 0.1);
    }
    @keyframes glow {
      0% {
        box-shadow: 0 0 10px rgba(206, 28, 28, 0.1),
                    0 0 20px rgba(11, 195, 63, 0.1),
                    0 0 30px rgba(231, 231, 12, 0.1);
      }
      100% {
        box-shadow: 0 0 20px rgba(198, 20, 211, 0.3),
                    0 0 40px rgba(132, 76, 104, 0.2),
                    0 0 60px rgba(6, 43, 228, 0.15);
      }
    }

    .popup {
      animation: popupIn 1s ease-out forwards;
      transform: scale(0.8);
      opacity: 0;
    }
    @keyframes popupIn {
      0% {
        transform: scale(0.8);
        opacity: 0;
      }
      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    .shake {
      animation: shake 0.3s;
    }

    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }
  </style>
</head>

<body class="min-h-screen bg-cover bg-center flex items-center justify-center bg-[url('../static/assets/staff_signup.jpg')]">

  <div class="popup glitter relative bg-black p-8 rounded-xl w-full max-w-2xl z-10 overflow-hidden">
    <h2 class="text-2xl text-center font-bold text-black bg-white px-6 py-2 rounded-full mb-6 w-fit mx-auto z-20">STAFF SIGN UP PAGE</h2>
    <form id="signupForm" class="space-y-4 text-white font-semibold z-20 relative">
  
    <div>
    <label for="id" class="block text-white">STAFF ID:</label>
    <input type="text" id="id" name="id" placeholder="Enter your staff_id" class="w-full border border-black px-4 py-2 rounded-md bg-white text-black" required />
  </div>
  <div>
    <label for="name" class="block text-white">NAME:</label>
    <input type="text" id="name" name="name" placeholder="Enter your name" class="w-full border border-black px-4 py-2 rounded-md bg-white text-black" required />
  </div>


  <div>
    <label for="phone" class="block text-white">PHONE:</label>
    <input type="tel" id="phone" name="phone" placeholder="Enter phone number" pattern="[0-9]{10}" maxlength="10" class="w-full border border-black px-4 py-2 rounded-md bg-white text-black" required />
  </div>
  <div>
    <label for="password" class="block text-white">PASSWORD:</label>
    <input type="password" id="password" name="password" placeholder="Create a password" class="w-full border border-black px-4 py-2 rounded-md bg-white text-black" required />
  </div>

  <div>
    <label for="confirmPassword" class="block text-white">CONFIRM PASSWORD:</label>
    <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm your password" class="w-full border border-black px-4 py-2 rounded-md bg-white text-black" required />
  </div>

  <div class="text-center pt-4">
    <button type="submit" class="bg-white text-black px-6 py-2 rounded-full hover:bg-gray-800 hover:text-white transition duration-300">Sign Up</button>
  </div>
</form>
</div>

  <script>
const form = document.getElementById("signupForm");

function validatePassword(password) {
  const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+=<>?{}[\]~])[A-Za-z\d!@#$%^&*()_\-+=<>?{}[\]~]{8,}$/;
  return regex.test(password);
}

form.addEventListener("submit", function (e) {
  e.preventDefault();
  const id = document.getElementById("id");
  const phone = document.getElementById("phone");
  const name = document.getElementById("name");
  const password = document.getElementById("password");
  const confirmPassword = document.getElementById("confirmPassword");

  let valid = true;

  [id, name, phone, password, confirmPassword].forEach(input => {
    input.classList.remove("shake");
  });

  if (id.value.trim() === "") { id.classList.add("shake"); valid = false; }
  if (name.value.trim() === "") { name.classList.add("shake"); valid = false; }
  if (phone.value.trim() === "") { phone.classList.add("shake"); valid = false; }
  if (password.value.trim() === "") { password.classList.add("shake"); valid = false; }
  if (confirmPassword.value.trim() === "") { confirmPassword.classList.add("shake"); valid = false; }

  if (password.value !== confirmPassword.value) {
    password.classList.add("shake");
    confirmPassword.classList.add("shake");
    alert("Passwords do not match!");
    valid = false;
  }

  if (!validatePassword(password.value)) {
    password.classList.add("shake");
    alert("Password must be at least 8 characters and include uppercase, lowercase, number, and special character!");
    valid = false;
  }

  if (valid) {
    fetch("/staff/signup", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        id: id.value.trim(),
        name: name.value.trim(),
        phone: phone.value.trim(),
        password: password.value
      })
    })
    .then(res => res.json())
    .then(data => {
      if (data.error) {
        alert("Error: " + data.error);
      } else {
        const container = document.querySelector(".popup");
        container.innerHTML = `
          <h2 class="text-2xl text-center text-white font-bold mb-4">ðŸŽ‰ Sign Up Successful!</h2>
          <p class="text-center text-white text-lg">Welcome, <span class="font-bold">${data.staff.name}</span>!</p>
        `;
        container.classList.add("glitter");
        setTimeout(() => { window.location.href = "/staff/login"; }, 2000);
      }
    })
    .catch(err => {
      console.error("Signup error:", err);
      alert(err);
    });
  }
});
</script>

</body>
</html>
